# 2\. Spring

## 2\.0\. Общая информация

Spring предлагает контейнер, часто называемый **контекстом приложения Spring**, который создает bean-компоненты приложения  
и управляет ими. Объединение bean-компонентов основан на шаблоне, известном как **внедрение зависимостей** (Dependency Injection, DI).  
Компоненты не создают и не поддерживают жизненный цикл других компонентов, от которых они зависят, а полагаются в этом  
на отдельный объект (контейнер), который создаст все нужные компоненты и внедрит их в другие компоненты, которые в них нуждаются.  
Это делается с помощью аргументов конструктора или методов доступа к свойствам. (TODO: почему внедрять через конструктор лучше?)

#### Автоматическая настройка

Используя **механизм сканирования**, Spring может автоматически обнаруживать компоненты в пути поиска классов (classpath) приложения   
и создавать их как bean-компоненты в контексте приложения Spring. **Механизм автоматического связывания** позволяет фреймворку Spring  
внедрять компоненты в другие bean-компоненты, от которых те зависят.

#### Spring Boot

**Автоконфигурация** – Spring Boot может делать обоснованные предположения о том, какие компоненты следует настроить и связать вместе,  
опираясь на элементы в пути поиска классов, переменные окружения и другие факторы.

## 2\.1\. Базовая конфигурация

#### Зависимости

Зависимости от Spring Boot Starter обычно не имеют своего библиотечного кода, а транзитивно подключают другие библиотеки.

- `org.springframework.boot` - основной плагин с указанием версии Spring Boot.
- `io.spring.dependency-management` - контроль версий транзитивных зависимостей.
- `org.jetbrains.kotlin.plugin.spring` - делает классы открытыми (open) в Kotlin для поддержки Spring AOP (CGLIB proxies) и Spring JPA,  
  с помощью следующих аннотаций: `@Component` (и производных `@Configuration`, `@Controller`, `@RestController`, `@Service`, `@Repository`),  
  `@Async`, `@Transactional`, `@Cacheable`, `@SpringBootTest`.
- `org.jetbrains.kotlin.plugin.jpa` - создает класс без параметров в Kotlin (вызываемый только с помощью рефлексии) для поддержки Spring JPA,  
  с помощью следующих аннотаций: `@Entity`, `@Embeddable` и `@MappedSuperclass`.
- `freeCompilerArgs.addAll("-Xjsr305=strict")` - для поддержки Kotlin null-safety в Spring.
- `org.jetbrains.kotlin:kotlin-reflect` - поддержка рефлексии.
- `com.fasterxml.jackson.module:jackson-module-kotlin` - поддержка сериализации/десериализации для классов Kotlin.
- `org.springframework.boot:spring-boot-starter-test`, `org.jetbrains.kotlin:kotlin-test-junit5`, `org.junit.platform:junit-platform-launcher` -  
  для тестирования.
- `org.springframework.boot:spring-boot-devtools` - инструменты разработчика, позволяют:
    - автоматически перезапускать приложение при изменении кода;
    - автоматически обновлять окно браузера при изменении ресурсов, передаваемых браузеру;
    - автоматически отключать кеширование шаблонов;
    - открывать встроенную консоль H2, если используется база данных H2.


- `io.github.oshai:kotlin-logging-jvm` - удобный логгинг в Kotlin.

#### Аннотации

- `@Configuration` - для класса конфигурации, в котором создаются bean-компоненты для контекста Spring.
- `@Bean` - для метода, в котором создается объект, который будет добавлен в контекст приложения как bean-компонент.  
  При создании объекта можно передать в качестве аргумента конструктора вызов другого bean-метода. Bean-компонент доступен   
  по идентификатору, совпадающему с именем метода.

## 2\.2\. Spring MVC

#### Зависимости

- `org.springframework.boot:spring-boot-starter-web` - подключение Spring MVC и встроенного сервера сервлетов Tomcat.
- `org.springframework.boot:spring-boot-starter-thymeleaf` - подключение механизма шаблонов Thymeleaf.

Когда приложение запускается, Sprint Boot:
- настраивает bean-компоненты в контексте приложения Spring для включения Spring MVC.
- настраивает встроенный сервер Tomcat в контексте приложения Spring.
- настраивает механизм шаблонов Thymeleaf для отображения представлений Spring MVC.

#### Аннотации

- `@SpringBootApplication` - для класса запуска приложения Spring Boot, состоит из аннотаций:
    - `@SpringBootConfiguration` - определяет этот класс как класс конфигурации, специализированная форма аннотации `@Configuration`.
    - `@EnableAutoConfiguration` - включает автоконфигурацию Spring Boot, Spring Boot автоматически настраивает необходимые компоненты.
    - `@ComponentScan` - включает обнаружение и регистрацию в контексте Spring компонентов с аннотацией `@Component` и ее производными.
- `@SpringBootTest` - настраивает JUnit на запуск тестов с поддержкой возможностей Spring Boot. Также выполняет загрузку контекста  
  приложения Spring для теста. Сама снабжена аннотацией `@ExtendWith(SpringExtension.class)`, добавляющей поддержку возможностей  
  тестирования Spring в JUnit 5.

## 2\.3\. Spring Data

### 2\.3\.1\. Spring JDBC

### 2\.3\.2\. Spring Data JDBC

### 2\.3\.2\. Spring Data JPA

## 2\.4\. Spring Security


## 2\.5\. Spring Reactive

Использование реактивного программирования направлено на обеспечение большей масштабируемости и улучшенной производительности  
за счет неблокирующих операций.

